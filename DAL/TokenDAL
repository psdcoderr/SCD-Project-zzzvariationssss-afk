

package DAL;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;
//CONNECTION WITH DB
public class TokenDAL {
    private static final String DB_URL = "jdbc:mysql://localhost:3306/project";
    private static final String DB_USER = "root";
    private static final String DB_PASSWORD = "";
//METHOD GETTIG ALL VERSES
//SELECT FROM THESE VERSES  FOR TOKENIZATION
    public List<String> getAllVerses() {
        List<String> allVerses = new ArrayList<>();
        try (Connection connection = DriverManager.getConnection(DB_URL, DB_USER, DB_PASSWORD)) {
            String selectQuery = "SELECT verse FROM Verses";
            try (PreparedStatement getVerses = connection.prepareStatement(selectQuery)) {
                try (ResultSet resultSet = getVerses.executeQuery()) {
                    while (resultSet.next()) {
                        String verse = resultSet.getString("verse");
                        allVerses.add(verse);
                    }
                }
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
        return allVerses;
    }
    //SELECT  AND RETURN VERSE ID FOR TOKENIZATION
    //SELECT ONLY SELECTED VERSES ID  FOR TOKENIZATION
    public int getVerseId(String verse) {
        int vId = -1;
        try (Connection connection = DriverManager.getConnection(DB_URL, DB_USER, DB_PASSWORD)) {
            String selectQuery = "SELECT v_id FROM Verses WHERE verse = ?";
            try (PreparedStatement getVerseIdStatement = connection.prepareStatement(selectQuery)) {
                getVerseIdStatement.setString(1, verse);
                try (ResultSet resultSet = getVerseIdStatement.executeQuery()) {
                    if (resultSet.next()) {
                        vId = resultSet.getInt("v_id");
                    }
                }
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
        return vId;
    }

}
